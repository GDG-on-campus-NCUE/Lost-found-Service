# 國立彰化師範大學 生輔組 - 自動化失物招領平台系統說明

## 1. 系統概述

本系統旨在提供一個高效、安全且易於管理的校園失物招領公告平台。透過整合 Google 表單、Google 試算表及 Google Apps Script 自動化腳本，本平台實現了從「拾獲回報」、「後台審核」到「公開上架」及「自動下架」的完整生命週期管理，並徹底分離了機密與公開資料，確保拾獲者的個資安全。

-   **前端公告網站**：[失物招領平台 (rpage)](https://stuaffweb.ncue.edu.tw/p/412-1039-4292.php)
-   **拾獲物品回報**：[線上回報表單](https://forms.gle/LaXeXCjMtK4wjHDW6)
-   **後台管理中心**：[Google 試算表公開存取節點](https://docs.google.com/spreadsheets/d/1yGWyvzR3Jr6dRpZBATVhSVvEcc0FMQrWHPBqbYrgIag/edit?usp=sharing)

---

## 2. 系統架構

本系統的核心由「一個前端」與「兩份後端資料表」構成，各司其職：

| 元件名稱                    | 工作表分頁 (Sheet)         | 功能說明                                                                                                                                                                                                                                                                |
| --------------------------- | -------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **機密資料庫 (後台)**       | `RAW_DATA`                 | 接收由 Google 表單傳入的**最原始、完整的資料**，包含拾獲者的姓名、學號、聯絡方式等**機密個資**。**此表僅供內部備查與資料校對使用，絕不對外公開。**                                                                                                        |
| **公開資料表 (後台)**       | `Public_Data`              | **前端網站的唯一資料來源**。此表透過公式，**自動且有選擇性地**從 `RAW_DATA` 中抓取**非機密的物品資訊**（如：物品名稱、照片、拾獲地點等）。只有在 `RAW_DATA` 中被標示為「上架」的物品，其資料才會出現在這裡。 |
| **前端公告網站 (rpage)**    | N/A                        | 完全獨立的靜態網頁，僅被授權讀取 `Public_Data` 工作表的內容，用以生成使用者看到的遺失物卡片列表與篩選功能。**前端程式碼完全無法存取到任何機密資訊。**                                                                                                 |
| **Google Apps Script** | N/A                        | 負責系統的自動化任務，包含：(1) 當有新物品回報時，自動寄送審核通知信給管理員。(2) 定期檢查 `Public_Data` 中物品的上架時間，若超過 6 個月則自動更新其狀態為「下架」。 |

---

## 3. 日常管理工作流程

管理員的日常操作非常簡單，僅需遵循以下流程：

### 步驟一：接收審核通知信

-   當有師生填寫回報表單後，系統會自動發送一封附有物品照片與詳細資訊的通知信至管理員信箱。

### 步驟二：登入後台進行審核

1.  點擊郵件中的「**前往試算表審核**」按鈕，或直接開啟**後台管理中心**。
2.  您會看到 `RAW_DATA` 和 `Public_Data` 兩個工作表。**您的主要操作將在 `RAW_DATA` 中進行。**

### 步驟三：校對內容與更新狀態 (在 `RAW_DATA` 操作)

1.  找到新進的資料列，檢查使用者填寫的物品名稱、描述等是否有誤。**若需修改文字，請直接在此工作表 (`RAW_DATA`) 的對應儲存格中修改。**
2.  確認無誤後，找到 **`狀態`** 欄位，點擊儲存格並從下拉選單中選擇：

    -   **選擇 `上架`**
        -   **效果**：該筆失物的公開資訊（不含個資）會**立即被同步到 `Public_Data` 工作表**，並顯示在前端網站上。
        -   **自動化**：系統會自動記錄上架時間，並從此刻起**倒數 6 個月**。時間一到，腳本會自動將此狀態更新為「**下架**」。

    -   **選擇 `已領取` 或 `已下架`**
        -   **效果**：該筆失物資料將**不會出現在 `Public_Data` 工作表中**，因此也不會顯示於前端網站。這也適用於手動下架或處理不實回報。

---

## 4. 重要管理原則【請務必詳讀】

### 📌 原則一：資料修改的黃金準則

> **所有文字內容的修改（例如錯字、補充描述），都必須在 `RAW_DATA` 工作表中完成。**
>
> **絕對不要**試圖在 `Public_Data` 工作表中修改任何資料，因為它所有內容均由公式自動從 `RAW_DATA` 同步而來，任何手動修改都會在下一次刷新時被覆蓋。

### 📌 原則二：如何「隱藏」一筆不當記錄

> 若遇到測試資料、不希望上架的紀錄，**請不要在 `RAW_DATA` 中「刪除整列」**，這會破壞資料的完整性。
>
> **正確做法**：直接在 `RAW_DATA` 工作表中，將該筆紀錄的 **`狀態` 調整為 `已下架`**。這樣它就永遠不會出現在公開網站上，同時也保留了最原始的紀錄以供備查。

### 📌 原則三：關於自動化欄位

> 在 `RAW_DATA` 與 `Public_Data` 中，部分欄位（如 `遺失物編號`、`圖片公開連結`、`上架時間` 等）均由系統自動生成或同步，**這些欄位是全自動的，請勿進行任何手動修改**。

### 💡 操作心法總結

-   **改文字、改描述？** → 請到 `RAW_DATA`。
-   **決定上架/下架？** → 請在 `RAW_DATA` 的 `狀態` 欄操作。
-   **想看公開的樣子？** → `Public_Data` 的內容就是網站上呈現的內容（僅供檢視）。
-   **要刪除一筆資料？** → 在 `RAW_DATA` 將 `狀態` 設為 `已下架`。

---

## 5. 前端技術規格

-   **資料串接**：透過 Google Sheets API (gviz) 接口，以唯讀方式抓取 `Public_Data` 工作表的 JSON 資料。
-   **核心邏輯**：使用原生 JavaScript (Vanilla JS) 進行資料獲取、篩選及頁面渲染。
-   **版面樣式**：使用 CSS3 進行排版與美化，並利用 CSS 變數 (Custom Properties) 進行主題色的管理。
-   **字體方案**：引入 Google Fonts 的 `Noto Sans TC` (思源黑體 繁體中文)，提供優雅且清晰的閱讀體驗。
-   **響應式設計**：支援桌面、平板與行動裝置，確保在各種螢幕尺寸下皆有良好瀏覽效果。